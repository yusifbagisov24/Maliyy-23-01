<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Maliyyə23/01 | Yükləmələr</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  margin:0; padding:0; color:#333;
}
header {
  background: #2c3e50; color:#fff; text-align:center; padding:20px 0;
}
header h1 { margin:0; font-size:28px;}
nav ul { list-style:none; padding:0; margin:10px 0 0; display:flex; justify-content:center; flex-wrap:wrap;}
nav ul li { margin:0 15px;}
nav ul li a { color:#ecf0f1; text-decoration:none; font-weight:bold; transition:color 0.3s;}
nav ul li a:hover { color:#e74c3c;}
main { max-width:800px; margin:40px auto; padding:0 20px;}
h2 { text-align:center; color:#004aad; margin-bottom:30px;}
.upload-container { background:#fff; padding:25px; border-radius:10px; box-shadow:0 4px 12px rgba(0,0,0,0.1);}
input[type=file] { display:none; }
label { background:#004aad; color:#fff; padding:12px 25px; border-radius:8px; cursor:pointer; font-weight:bold; display:inline-block; margin-bottom:20px;}
label:hover { background:#0066ff; }
ul.file-list { list-style:none; padding:0; }
ul.file-list li { background:#f9f9f9; margin-bottom:10px; padding:10px 15px; border-radius:6px; box-shadow:0 2px 6px rgba(0,0,0,0.05);}
footer { text-align:center; padding:20px 0; background:#2c3e50; color:#fff; margin-top:40px;}
footer p span { display:block; margin-top:5px; font-weight:bold; color:#e74c3c; }

@media (max-width:768px){
  nav ul { flex-direction:column; }
  .upload-container { padding:20px; }
}
</style>
</head>
<body>

<header>
  <h1>📤 Maliyyə23/01 - Yükləmələr</h1>
  <nav>
    <ul>
      <li><a href="index.html">Ana səhifə</a></li>
      <li><a href="cedvel.html">Dərs cədvəli</a></li>
      <li><a href="materiallar.html">Materiallar</a></li>
      <li><a href="elanlar.html">Elanlar</a></li>
      <li><a href="upload.html">Yükləmələr</a></li>
    </ul>
  </nav>
</header>

<main>
<h2>📂 Material Yükləmələri</h2>
<div class="upload-container">
  <label for="fileUpload">Fayl seç və yüklə</label>
  <input type="file" id="fileUpload" />
  <ul class="file-list" id="fileList"></ul>
</div>
</main>

<footer>
<p>© 2025 Maliyyə23/01 Qrupu
  <span>Hazırladı: Yusif Bağışov</span>
</p>
</footer>

<!-- Supabase JS SDK -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  // 1️⃣ Supabase məlumatları
  const supabaseUrl = 'https://jlenspqqvtauqinxefho.supabase.co';
  const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpsZW5zcHFxdnRhdXFpbnhlZmhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3NzU5MDksImV4cCI6MjA3NTM1MTkwOX0.KGHAC047Crvd8T5UzNaCuRxGXDisC6up4qm1SNmazMs';
  const supabase = Supabase.createClient(supabaseUrl, supabaseKey);

  const fileInput = document.getElementById('fileUpload');
  const fileList = document.getElementById('fileList');

  // 2️⃣ Faylları siyahıla
  async function listFiles() {
    const { data, error } = await supabase.storage.from('materials').list();
    if(error) console.error(error);
    else {
      fileList.innerHTML = '';
      data.forEach(f => {
        const li = document.createElement('li');
        li.innerHTML = `📄 <a href="https://jlenspqqvtauqinxefho.supabase.co/storage/v1/object/public/materials/${f.name}" target="_blank">${f.name}</a>`;
        fileList.appendChild(li);
      });
    }
  }

  // 3️⃣ Fayl yüklə
  fileInput.addEventListener('change', async () => {
    const file = fileInput.files[0];
    if(file){
      const { data, error } = await supabase.storage.from('materials').upload(file.name, file, { upsert:true });
      if(error) alert('Yükləmə xətası: ' + error.message);
      else {
        alert('Fayl uğurla yükləndi!');
        listFiles();
      }
    }
  });

  // 4️⃣ İlk açılışda faylları göstər
  listFiles();
</script>

</body>
</html>
